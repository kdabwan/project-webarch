<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="utf-8">
	<title>Web Architecture Project</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
	<link href="static/css/default.css" rel="stylesheet" >

	<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
	<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
	<script src="http://code.jquery.com/ui/1.11.1/jquery-ui.min.js"></script>
	<script src="./static/bootstrap/js/jquery.cookie.js"></script>
	<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.js" type="text/javascript"></script>
</head>
<body>
	<div class="content">
		<!--Sign in/up business starts here .............................-->
		<div class="sign-area"  id="sign-area">
		</div>
		<!-- Modal -->
		<div class="modal fade bs-modal-sm" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModal" aria-hidden="true">

			<div class="modal-dialog modal-sm">
				<div class="modal-content">
					<br>
					<div class="bs-example bs-example-tabs">
						<ul id="myTab" class="nav nav-tabs">
							<li class="active"><a href="#signin-form" data-toggle="tab">Sign In</a></li>
							<li class=""><a href="#signup" data-toggle="tab">Register</a></li>
						</ul>
					</div>
					<div class="modal-body">
						<div id="myTabContent" class="tab-content">
							
							<div class="tab-pane fade active in" id="signin-form">
								<form class="form-horizontal" method="POST">
									<fieldset>
										
										<!-- Sign In Form -->
										<!-- Text input-->
										<div class="control-group">
											<label class="control-label" for="username-signin">Username:</label>
											<div class="controls ">
												<input required="" id="username-signin" name="username" type="text" class="form-control input-medium" placeholder="username"  >
											</div>
										</div>

										<!-- Password input-->
										<div class="control-group">
											<label class="control-label" for="passwordinput">Password:</label>
											<div class="controls">
												<input required="" id="passwordinput" name="password" class="form-control input-medium" type="password" placeholder="********" >
											</div>
										</div>

										<!-- Button -->
										<div class="control-group">
											<label class="control-label" for="signin"></label>
											<div class="controls">
												<button id="signin" name="sign" value="signin" class="btn btn-success">Sign In</button>
											</div>
										</div>
									</fieldset>
								</form>
							</div>
							<div class="tab-pane fade" id="signup">
								<form class="form-horizontal" method="POST" id="signup-form">
									<fieldset>
										<!-- Sign Up Form -->
										<!-- Text input-->
										<div class="control-group">
											<label class="control-label" for="firstname">First Name:</label>
											<div class="controls">
												<input id="firstname" name="firstname" class="form-control input-large" type="text" placeholder="John"  required="">
											</div>
										</div>

										<!-- Text input-->
										<div class="control-group">
											<label class="control-label" for="lastname">Last Name:</label>
											<div class="controls">
												<input id="lastname" name="lastname" class="form-control input-large" type="text" placeholder="Freeman"  required="">
											</div>
										</div>

										<!-- Text input-->
										<div class="control-group">
											<label class="control-label" for="email">Email:</label>
											<div class="controls">
												<input id="email" name="email" class="form-control input-large" type="email" placeholder="name@example.com" required="">
											</div>
										</div>
										
										<!-- Text input-->
										<div class="control-group">
											<label class="control-label" for="username">Username:</label>
											<div class="controls">
												<input id="username" name="username" class="form-control input-large" type="text" placeholder="username"  required="" pattern=".{5,}" title="5 characters minimum">
											</div>
										</div>
										
										<!-- Password input-->
										<div class="control-group">
											<label class="control-label" for="password">Password:</label>
											<div class="controls">
												<input id="password" name="password" class="form-control input-large" type="password" placeholder="********"  required="" pattern=".{6,}" title="6 characters minimum">
												<em>1-8 Characters</em>
											</div>
										</div>
										
										<!-- Text input-->
										<div class="control-group">
											<label class="control-label" for="reenterpassword">Re-Enter Password:</label>
											<div class="controls">
												<input id="reenterpassword" class="form-control input-large" name="reenterpassword" type="password" placeholder="********"  required="" pattern=".{6,}" title="6 characters minimum">
											</div>
										</div>
										
										<!-- Button -->
										<div class="control-group">
											<label class="control-label" for="confirmsignup"></label>
											<div class="controls">
												<button id="confirmsignup" value="signup" name="sign" class="btn btn-success">Sign Up</button>
											</div>
										</div>
									</fieldset>
								</form>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						
						<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
						
					</div>
				</div>
			</div>
		</div>
		<!-- Dialog-->
		<!-- Modal -->
		<div class="modal fade bs-modal-sm" id="success" tabindex="-1" role="dialog"  aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header modal-header-success">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
						<h1><i class="glyphicon glyphicon-thumbs-up"></i> Thank You!</h1>
					</div>
					<div class="modal-body">
						<h3 class="message">You have successfully signed up!!!</h3>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default pull-right" data-dismiss="modal">Cool!</button>
					</div>
				</div><!-- /.modal-content -->
			</div><!-- /.modal-dialog -->
		</div><!-- /.modal -->

		<!-- Modal -->
		<div class="modal fade bs-modal-sm" id="fail" tabindex="-1" role="dialog"  aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header modal-header-danger">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
						<h1><i class="glyphicon glyphicon-thumbs-down"></i> Opps!</h1>
					</div>
					<div class="modal-body">
						<h2 class="message">Failed! check your username and/or password!</h2>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default pull-right" data-dismiss="modal">OK!</button>
					</div>
				</div><!-- /.modal-content -->
			</div><!-- /.modal-dialog -->
		</div><!-- /.modal -->

		
		<!--Sign in/up business ENDS here .............................-->
		
		<!-- first non-form tag 1.2 -->
		<div class="centered-box">
			<img src="static/url_shortener.png" class="centered-image" alt="logo">
			<!-- second non-form tag 1.2 -->
			<h1>Web Architecture Project</h1>
			<form class="form-horizontal" method="POST" action="shorts">
				<!-- first text field with label 1.1-->
				<div class="col-lg-12" >
					<label for="long_url" class="label">Enter url to shorten<span class="label label-default"></span></label>
					<div class="input-group" >
						<input type="text" class="form-control"  placeholder="http://www.example.com" id="long_url" name="long_url" autocomplete="off">
						<span class="input-group-btn">
							<button class="btn btn-default" type="submit" value="Submit" id ="shortenBTN">Shorten! </button>
						</span>
					</div>
				</div>
				<!-- third non-form tag 1.2 -->
				<p class="fine-print">* Only valid URL format i.e.,URL must start with http:// or https://</p>
				<!-- second text field with label 1.1-->
				<div class="col-lg-12">
					<div class="input-group">
						<label class="label"> Customize url (Optional) <input type="text" class="form-control" placeholder="e.g. expl" id ="customized_url" name="short_str"  onkeyup="checkCharOnly(document.getElementById('customized_url').value);"></label>
					</div>
				</div>
				<!-- forth non-form tag 1.2 -->
				<!--  <p class="fine-print">* only valid string</p>-->
				<p class="fine-print"><b id='errorMessage'></b> </p> 
				
			</form>
		</div>
	</div>
	<script>
		$(document).ready(function() {
			$("#shortenBTN").attr('disabled', 'disabled');
			$("form").on('blur keyup change',function() {
				var long_url = $("#long_url").val();
				var filter = new RegExp("^(http|https|ftp)\://([a-zA-Z0-9\.\-]+(\:[a-zA-Z0-9\.&amp;%\$\-]+)*@)*((25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])|([a-zA-Z0-9\-]+\.)*[a-zA-Z0-9\-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(\:[0-9]+)*(/($|[a-zA-Z0-9\.\,\?\'\\\+&amp;%\$#\=~_\-]+))*$");
				if (long_url !="" && filter.test(long_url)) {
					var customized_url = $("#customized_url").val();
					var chars = /^[A-Za-z]*$/;
					if (chars.test(customized_url)) {
						document.getElementById('errorMessage').innerHTML = '';
						document.getElementById("shortenBTN").disabled = false;
					}else{
						document.getElementById("shortenBTN").disabled = true;	
						document.getElementById('errorMessage').innerHTML = 'Please only use Letters';		
					};
				} else {
					document.getElementById("shortenBTN").disabled = true;
				};
				
			});

{% block body %}
					// to show successful sign up  message
					{% if signup_success %}
					$('#success').modal('show');
					{% endif %}
					// to show failed sign in  message
					{% if signin_fail %}
					$('#fail').modal('show');
					{% endif %}
					{% endblock %}
				// logon user sees registered user menu, sign in button otherwise
				if($.cookie('username') === null || $.cookie('username') === "" 
					|| $.cookie('username') === "null" || $.cookie('username') === undefined)
				{
					var button = "<button  href=\"#\" id=\"sign-btn\" class=\"btn btn-primary btn-success\" data-toggle=\"modal\" data-target=\"#myModal\">Sign In/Register</button>";
					$('#sign-area').append( button);
				}
				else
				{
					var name= $.cookie('name');
					var user = " <div class=\"member\">\
					<ul class=\"nav navbar-nav navbar-fixed-top \" >\
						<li class=\"dropdown\">\
							<a href=\"#\" class=\"dropdown-toggle user\" data-toggle=\"dropdown\"><span class=\"glyphicon glyphicon-user pull-left\"></span> <span class=\"name\">"+ name +"</span></a>\
							<ul class=\"dropdown-menu\">\
								<div class=\"navbar-login\">\
									<li><a class=\"li-menu\" href=\"./home\" id=\"home\">Home <span class=\"glyphicon glyphicon-home pull-right\"></span></a></li>\
									<li class=\"divider\"></li>\
									<li><a class=\"li-menu\" href=\"./profile\">Profile <span class=\"glyphicon glyphicon-cog pull-right\"></span></a></li>\
									<li class=\"divider\"></li>\
									<li><a class=\"li-menu\" href=\"links\">My links <span class=\"glyphicon glyphicon-heart pull-right\"></span></a></li>\
									<li class=\"divider\"></li>\
									<li><a class=\"li-menu\"href=\"#\" id=\"sign-out\">Sign Out <span class=\"glyphicon glyphicon-log-out pull-right\"></span></a></li>\
								</div>\
							</ul>\
						</li>\
					</ul>\
				</div>";
				$('#sign-area').append( user);
			}
						// Click sign out ot delete cookie and refresh
						$('#sign-out').click(function(){
							$.removeCookie('username', { path: '/' }); 
							$.removeCookie('name', { path: '/' });
							location.reload(true);
							return false; 
						});
						
						
						
					});
</script>
</body>
</html>

